:root{--primary-color:#4F46E5;--secondary-color:#6366F1;--success-color:#10B981;--esp32-color:#EF4444;--pico-color:#8B5CF6;--warning-color:#F59E0B;--gray-50:#F9FAFB;--gray-100:#F3F4F6;--gray-200:#E5E7EB;--gray-700:#374151;--gray-800:#1F2937;--gray-900:#111827;--text-xs:11px;--text-sm:12px;--text-base:13px;--text-md:14px;--text-lg:16px;--text-xl:18px}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--gray-100);height:100vh;overflow:hidden;color:var(--gray-800)}.ide-container{display:grid;grid-template-columns:1fr 400px;grid-template-rows:60px 1fr;height:100vh;gap:8px;padding:8px}.toolbar{grid-column:1/-1;background:#fff;border-radius:8px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;box-shadow:0 1px 3px rgba(0,0,0,.08);border-bottom:1px solid var(--gray-200)}.toolbar-left{display:flex;align-items:center;gap:15px}.toolbar-logo{height:40px;width:auto}.toolbar h1{color:var(--gray-800);font-size:20px;font-weight:600;display:flex;align-items:center;gap:10px}.mode-toggle{display:flex;background:var(--gray-100);border-radius:8px;padding:3px;gap:2px}.mode-btn{padding:5px 14px;border:none;border-radius:6px;background:0 0;cursor:pointer;font-size:var(--text-base);font-weight:500;transition:.2s;color:#666}.mode-btn.active{background:var(--primary-color);color:#fff;box-shadow:0 1px 3px rgba(79,70,229,.3)}.toolbar-buttons{display:flex;gap:12px;align-items:center}.btn{padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-size:var(--text-base);font-weight:500;transition:.2s;display:flex;align-items:center;gap:6px;box-shadow:0 1px 2px rgba(0,0,0,.05)}.btn-compile{background:var(--primary-color);color:#fff}.btn-upload{background:var(--success-color);color:#fff}.btn:disabled{background:var(--gray-200);color:#9ca3af;cursor:not-allowed;opacity:.7}.btn:hover:not(:disabled){opacity:.9}.editor-area{display:grid;grid-template-columns:1fr;gap:0;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.08)}.editor-area:not(.text-mode) .code-panel{display:none}.editor-area.text-mode{grid-template-rows:1fr}.blockly-panel{display:flex;flex-direction:column;background:#f8f9fa}.blockly-panel.hidden{display:none}.blockly-header{background:var(--gray-50);color:var(--gray-700);padding:10px 16px;font-weight:600;font-size:var(--text-md);display:flex;align-items:center;gap:8px;border-bottom:1px solid var(--gray-200);border-left:3px solid var(--primary-color);justify-content:flex-start}#blocklyDiv{flex:1;min-height:0}.code-panel{display:flex;flex-direction:column;background:#1e1e1e}.code-header{background:#252526;color:#ccc;padding:15px 20px;font-weight:600;border-bottom:1px solid #3c3c3c;display:flex;justify-content:space-between;align-items:center}.copy-btn{background:var(--primary-color);color:#fff;border:none;border-radius:6px;padding:6px 14px;cursor:pointer;font-size:12px;display:flex;align-items:center;gap:6px;transition:opacity .2s}.copy-btn:hover{opacity:.85}.code-content{flex:1;overflow:hidden;position:relative}#codePreview{color:#d4d4d4;font-family:'Courier New',Courier,monospace;font-size:14px;padding:20px;margin:0;white-space:pre-wrap;word-wrap:break-word;height:100%;overflow-y:auto;background:#1e1e1e}#monacoEditor{position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%}.editor-area.text-mode .code-panel{display:flex;flex-direction:column;height:100%}.editor-area.text-mode .code-content{flex:1;position:relative;min-height:0}#monacoEditor,#monacoEditor .monaco-editor,#monacoEditor .monaco-editor .monaco-scrollable-element,#monacoEditor .monaco-editor .overflow-guard{direction:ltr!important;text-align:left!important;unicode-bidi:embed!important}.rtl #monacoEditor,[dir=rtl] #monacoEditor{direction:ltr!important;text-align:left!important}#monacoEditor .monaco-editor .view-line,#monacoEditor .monaco-editor .view-line span,#monacoEditor .monaco-editor .view-lines{direction:ltr!important;text-align:left!important;unicode-bidi:embed!important}#monacoEditor .monaco-editor .monaco-scrollable-element .monaco-editor-background{direction:ltr!important}#monacoEditor .monaco-editor textarea{direction:ltr!important;text-align:left!important}.control-panel{background:#fff;border-radius:8px;padding:12px;box-shadow:0 1px 3px rgba(0,0,0,.08);display:flex;flex-direction:column;gap:10px;overflow-y:auto}.panel-section{background:var(--gray-50);border-radius:8px;padding:10px;border-left:3px solid var(--primary-color)}.panel-section h3{font-size:var(--text-base);margin-bottom:8px;color:var(--gray-700);font-weight:600;display:flex;align-items:center;gap:6px}.panel-section.console-section{padding:8px}.panel-section.console-section h3{margin-bottom:8px;font-size:13px}.form-row{display:flex;gap:8px;margin-bottom:10px;align-items:center}.form-row:last-child{margin-bottom:0}.form-row label{font-size:var(--text-sm);font-weight:500;color:#666;min-width:50px}.form-row input[type=text],.form-row select{flex:1;padding:8px 12px;border:1px solid var(--gray-200);border-radius:6px;font-size:var(--text-base);background:#fff}.form-row input[type=text]:focus,.form-row select:focus{outline:0;border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(79,70,229,.15)}.form-row button{padding:8px 16px;background:var(--primary-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:var(--text-sm);font-weight:500;white-space:nowrap;transition:.2s;display:flex;align-items:center;gap:4px}.form-row button:hover{background:var(--secondary-color)}.form-row button.success{background:var(--success-color)}.form-row button.success:hover{background:#059669}.form-row button.icon-btn{padding:8px;min-width:36px;display:flex;align-items:center;justify-content:center}.download-selector,.port-selector{display:flex;gap:6px;align-items:center}.download-selector .icon-btn,.port-selector .icon-btn{min-width:72px}.download-selector .icon-btn .icon,.port-selector .icon-btn .icon{stroke:#111}.language-status{font-size:var(--text-xs);color:var(--success-color);margin-left:8px;padding:2px 6px;background:rgba(16,185,129,.1);border-radius:6px}.board-indicator{display:inline-block;padding:4px 10px;border-radius:6px;font-size:var(--text-xs);font-weight:600;margin-left:10px;color:#fff}.board-arduino{background-color:#0ea5e9}.board-esp32{background-color:var(--esp32-color)}.board-pico{background-color:var(--pico-color)}.console-panel{background:var(--gray-900);border-radius:6px;padding:8px;display:flex;flex-direction:column;min-height:350px;max-height:500px}.console-header{color:var(--gray-200);margin-bottom:8px;font-size:var(--text-base);font-weight:600;display:flex;align-items:center;gap:8px}.console-output{flex:1;background:#0f172a;color:#a7f3d0;border-radius:6px;padding:8px;font-family:'Cascadia Code',Monaco,'Courier New',monospace;font-size:var(--text-xs);overflow-y:auto;white-space:pre-wrap;min-height:320px}.hidden{display:none!important}.loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:9999;color:#fff;font-size:18px}.loading-content{text-align:center}.loading-spinner{width:40px;height:40px;border:3px solid var(--gray-200);border-top:3px solid var(--primary-color);border-radius:50%;animation:1s linear infinite spin;margin:0 auto 20px}@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}.blocklyToolboxDiv .blocklyTreeRow{margin:8px 0!important;padding:8px!important}.blocklyToolboxDiv .blocklyToolboxCategory{margin-bottom:8px!important}.blocklyScrollbarVertical .blocklyScrollbarHandle{width:10px!important;rx:2.5px!important}.blocklyScrollbarHorizontal .blocklyScrollbarHandle{height:10px!important;ry:2.5px!important}.blocklyScrollbarVertical{width:10px!important}.blocklyScrollbarHorizontal{height:10px!important}.rtl{direction:rtl}.rtl .code-panel{order:-1}.icon{width:16px;height:16px;flex-shrink:0;vertical-align:middle}.btn .icon,.copy-btn .icon{stroke:white}.form-row button .icon{stroke:white;width:14px;height:14px}.blockly-header .icon,.panel-section h3 .icon{stroke:var(--gray-700)}.code-header .icon{stroke:#ccc}.icon-btn .icon{stroke:white;width:14px;height:14px}.panel-toggle-btn{background:0 0;border:1px solid var(--gray-200);border-radius:6px;cursor:pointer;padding:6px;display:flex;align-items:center;justify-content:center;transition:.2s;color:var(--gray-700)}.panel-toggle-btn:hover{background:var(--gray-100)}.panel-toggle-btn .icon{stroke:var(--gray-700)}.ide-container.panel-collapsed{grid-template-columns:1fr}.ide-container.panel-collapsed .control-panel{display:none}.ide-container{transition:grid-template-columns .2s}@media (max-width:1400px){.ide-container:not(.panel-collapsed){grid-template-columns:1fr 360px}}@media (max-width:1200px){.ide-container:not(.panel-collapsed){grid-template-columns:1fr 320px}.toolbar h1{font-size:18px}}@media (max-width:1024px){.ide-container,.ide-container.panel-collapsed{display:flex;flex-direction:column;height:auto;overflow-y:auto;grid-template-rows:unset}.toolbar{flex-wrap:wrap;padding:8px 16px;gap:8px;min-height:56px;height:auto}.toolbar-left{flex-direction:row;flex-wrap:wrap;gap:8px}.toolbar h1{font-size:16px}.editor-area{min-height:500px;order:1}.control-panel{order:2;max-height:600px}.console-panel{max-height:350px;min-height:250px;padding:6px}.console-output{padding:6px;min-height:220px}.panel-toggle-btn{display:none}}@media (max-width:768px){.ide-container{padding:4px;gap:4px}.toolbar{border-radius:6px;padding:6px 12px}.toolbar-logo{height:28px}.toolbar h1{font-size:14px}.toolbar-buttons{gap:6px}.btn{padding:6px 10px;font-size:var(--text-xs)}.btn .icon{width:14px;height:14px}.btn span{display:none}.editor-area{min-height:400px;border-radius:6px}.control-panel{border-radius:6px;padding:8px;gap:8px}}body.dark-mode{background:#0f172a;color:#e2e8f0}body.dark-mode .toolbar{background:#1e293b;border-bottom-color:#334155;box-shadow:0 1px 3px rgba(0,0,0,.3)}body.dark-mode .toolbar h1{color:#f1f5f9}body.dark-mode .mode-toggle{background:#334155}body.dark-mode .mode-btn{color:#94a3b8}body.dark-mode .mode-btn.active{background:var(--primary-color);color:#fff}body.dark-mode .dark-mode-toggle,body.dark-mode .panel-toggle-btn{border-color:#475569;color:#cbd5e1}body.dark-mode .dark-mode-toggle:hover,body.dark-mode .panel-toggle-btn:hover{background:#334155}body.dark-mode .dark-mode-toggle .icon,body.dark-mode .panel-toggle-btn .icon{stroke:#CBD5E1}body.dark-mode .editor-area{background:#1e293b;box-shadow:0 1px 3px rgba(0,0,0,.3)}body.dark-mode .blockly-panel{background:#1e293b}body.dark-mode .blockly-header{background:#1e293b;color:#cbd5e1;border-bottom-color:#334155;border-left-color:var(--secondary-color)}body.dark-mode .blockly-header .icon{stroke:#CBD5E1}body.dark-mode .code-header{background:#1a1a2e;border-bottom-color:#334155}body.dark-mode .control-panel{background:#1e293b;box-shadow:0 1px 3px rgba(0,0,0,.3)}body.dark-mode .panel-section{background:#0f172a;border-left-color:var(--secondary-color)}body.dark-mode .panel-section h3{color:#cbd5e1}body.dark-mode .panel-section h3 .icon{stroke:#CBD5E1}body.dark-mode .form-row label{color:#94a3b8}body.dark-mode .form-row input[type=text],body.dark-mode .form-row select{background:#1e293b;color:#e2e8f0;border-color:#475569}body.dark-mode .form-row input[type=text]:focus,body.dark-mode .form-row select:focus{border-color:var(--secondary-color);box-shadow:0 0 0 2px rgba(99,102,241,.25)}body.dark-mode .form-row select option{background:#1e293b;color:#e2e8f0}body.dark-mode .download-selector .icon-btn .icon,body.dark-mode .port-selector .icon-btn .icon{stroke:#111}body.dark-mode .language-status{background:rgba(99,102,241,.15);color:var(--secondary-color)}body.dark-mode .console-output,body.dark-mode .console-panel{background:#020617}body.dark-mode .loading-overlay{background:rgba(15,23,42,.9)}body.dark-mode .loading-spinner{border-color:#334155;border-top-color:var(--secondary-color)}body.dark-mode .popup-modal{background:#1e293b;box-shadow:0 4px 12px rgba(0,0,0,.4)}body.dark-mode .popup-content{color:#cbd5e1}body.dark-mode .popup-footer{background:#0f172a;border-top-color:#334155}body.dark-mode .popup-checkbox{color:#94a3b8}body.dark-mode .agent-connection-panel{background:#0f172a;border-color:#334155}.dark-mode-toggle{background:0 0;border:1px solid var(--gray-200);border-radius:6px;cursor:pointer;padding:6px;display:flex;align-items:center;justify-content:center;transition:.2s;color:var(--gray-700)}.dark-mode-toggle:hover{background:var(--gray-100)}.dark-mode-toggle .icon{stroke:var(--gray-700)}.dark-mode-toggle .icon-moon{display:block}.dark-mode-toggle .icon-sun,body.dark-mode .dark-mode-toggle .icon-moon{display:none}body.dark-mode .dark-mode-toggle .icon-sun{display:block}body.dark-mode .btn:disabled{background:#334155;color:#64748b}body.dark-mode .blocklyToolboxContents,body.dark-mode .blocklyToolboxDiv{background:#1a1f35!important}body.dark-mode .blocklyTreeRow{background-color:transparent!important}body.dark-mode .blocklyTreeRow:hover{background-color:rgba(255,255,255,.08)!important}body.dark-mode .blocklyToolboxCategoryLabel,body.dark-mode .blocklyTreeLabel{color:#cbd5e1!important}body.dark-mode .blocklyFlyoutBackground{fill:#1a1f35!important}body.dark-mode .blocklyMainBackground{fill:#1E293B!important}.form-row button.btn-share{background:var(--warning-color);color:#1f2937;font-weight:600}.form-row button.btn-share:hover{background:#d97706}.form-row button.btn-share .icon{stroke:#1F2937}.share-modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:10000;justify-content:center;align-items:center;backdrop-filter:blur(2px)}.share-modal-overlay.active{display:flex}.share-modal{background:#fff;border-radius:16px;width:90%;max-width:460px;max-height:85vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:.25s ease-out shareModalSlideIn}@keyframes shareModalSlideIn{from{opacity:0;transform:translateY(20px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}.share-modal-header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:#38bdf8;border-radius:16px 16px 0 0;color:#fff}.share-modal-header h3{margin:0;font-size:16px;font-weight:700;display:flex;align-items:center;gap:8px}.share-modal-header .share-close-btn{background:0 0;border:none;color:#fff;cursor:pointer;padding:4px;border-radius:6px;line-height:1;font-size:20px;opacity:.8;transition:opacity .15s}.share-modal-header .share-close-btn:hover{opacity:1;background:rgba(255,255,255,.15)}.share-modal-body{padding:20px}.share-step{display:none}.share-step.active{display:block}.share-project-info{display:flex;align-items:center;gap:14px;padding:14px;background:var(--gray-50);border-radius:10px;margin-bottom:16px}.share-project-icon{width:48px;height:48px;border-radius:10px;background:#38bdf8;display:flex;align-items:center;justify-content:center;flex-shrink:0}.share-project-icon svg{width:28px;height:28px;stroke:white;fill:none}.share-project-meta{flex:1;min-width:0}.share-project-meta .share-block-count{font-size:12px;color:var(--gray-700);margin-top:4px}.share-title-input{width:100%;padding:10px 12px;border:2px solid var(--gray-200);border-radius:8px;font-size:14px;font-weight:600;color:#1f2937;outline:0;transition:border-color .2s;box-sizing:border-box}.share-title-input:focus{border-color:#38bdf8}.share-title-label{display:block;font-size:13px;font-weight:600;color:var(--gray-700);margin-bottom:6px}.share-publish-btn{width:100%;padding:12px;background:#38bdf8;color:#fff;border:none;border-radius:10px;font-size:15px;font-weight:700;cursor:pointer;margin-top:16px;transition:background .2s;display:flex;align-items:center;justify-content:center;gap:8px}.share-publish-btn:hover{background:#0ea5e9}.share-publish-btn:disabled{background:var(--gray-200);color:var(--gray-700);cursor:not-allowed}.share-status-msg{text-align:center;font-size:13px;margin-top:10px;min-height:20px;color:var(--gray-700)}.share-status-msg.error{color:#ef4444}.share-status-msg.loading{color:#38bdf8}.share-success-msg{text-align:center;padding:12px;background:#e0f2fe;border-radius:10px;margin-bottom:16px;color:#0369a1;font-weight:600;font-size:14px}.share-link-section{margin-bottom:16px}.share-link-section label{display:block;font-size:13px;font-weight:600;color:var(--gray-700);margin-bottom:6px}.share-link-row{display:flex;gap:8px}.share-link-row input{flex:1;padding:9px 12px;border:2px solid var(--gray-200);border-radius:8px;font-size:13px;color:#374151;background:var(--gray-50);outline:0;min-width:0}.share-link-row input:focus{border-color:#38bdf8}.share-copy-btn{padding:9px 14px;background:#38bdf8;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;white-space:nowrap;transition:background .2s}.share-copy-btn:hover{background:#0ea5e9}.share-embed-toggle{display:flex;align-items:center;gap:6px;font-size:13px;color:#0ea5e9;cursor:pointer;border:none;background:0 0;padding:6px 0;font-weight:600;margin-bottom:8px}.share-embed-toggle:hover{text-decoration:underline}.share-embed-content{display:none;margin-bottom:16px}.share-embed-content.active{display:block}.share-embed-content textarea{width:100%;height:60px;padding:8px 10px;border:2px solid var(--gray-200);border-radius:8px;font-size:12px;font-family:monospace;resize:none;color:#374151;background:var(--gray-50);box-sizing:border-box;outline:0}.share-embed-content textarea:focus{border-color:#38bdf8}.share-sns-label{display:block;font-size:13px;font-weight:600;color:var(--gray-700);margin-bottom:10px}.share-sns-buttons{display:flex;gap:12px;justify-content:center}.share-sns-btn{width:44px;height:44px;border-radius:50%;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:transform .15s,box-shadow .15s}.share-sns-btn:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(0,0,0,.15)}.share-sns-btn svg{width:22px;height:22px}.share-sns-btn.sns-x{background:#000;color:#fff}.share-sns-btn.sns-facebook{background:#1877f2;color:#fff}.share-sns-btn.sns-kakao{background:#fee500;color:#3c1e1e}.share-sns-btn.sns-embed{background:#6b7280;color:#fff}.share-sns-btn.sns-classroom{background:#1aa260;color:#fff}.share-sns-btn.sns-teams{background:#5b5fc7;color:#fff}.share-sns-btn.sns-whatsapp{background:#25d366;color:#fff}.share-sns-btn.sns-webshare{background:#374151;color:#fff}.share-warning{display:none;padding:10px 12px;background:#fef3c7;border:1px solid #f59e0b;border-radius:8px;font-size:12px;color:#92400e;margin-top:12px;line-height:1.4}body.dark-mode .share-modal{background:#1e293b;color:#e2e8f0}body.dark-mode .share-modal-header{background:#0284c7}body.dark-mode .share-project-info{background:#0f172a}body.dark-mode .share-title-input{background:#0f172a;border-color:#334155;color:#e2e8f0}body.dark-mode .share-title-input:focus{border-color:var(--secondary-color)}body.dark-mode .share-link-section label,body.dark-mode .share-project-meta .share-block-count,body.dark-mode .share-sns-label,body.dark-mode .share-title-label{color:#94a3b8}body.dark-mode .share-success-msg{background:#0c4a6e;color:#bae6fd}body.dark-mode .share-embed-content textarea,body.dark-mode .share-link-row input{background:#0f172a;border-color:#334155;color:#e2e8f0}body.dark-mode .share-embed-toggle{color:#818cf8}body.dark-mode .share-warning{background:#422006;border-color:#92400e;color:#fde68a}body.dark-mode .share-status-msg{color:#94a3b8}body.dark-mode .share-status-msg.error{color:#fca5a5}body.dark-mode .share-status-msg.loading{color:#818cf8}body.dark-mode .form-row button.btn-share{background:#d97706;color:#fff}body.dark-mode .form-row button.btn-share:hover{background:#b45309}body.dark-mode .form-row button.btn-share .icon{stroke:#FFF}@media (max-width:768px){.share-modal{width:95%;max-width:none;border-radius:12px}.share-modal-header{border-radius:12px 12px 0 0;padding:14px 16px}.share-modal-body{padding:16px}.share-sns-buttons{gap:10px}.share-sns-btn{width:40px;height:40px}}.consent-dialog-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000;backdrop-filter:blur(3px)}.consent-dialog{background:#fff;border-radius:16px;padding:32px;max-width:420px;width:90%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:.3s ease-out consentSlideIn}@keyframes consentSlideIn{from{opacity:0;transform:translateY(20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.consent-dialog-icon{font-size:48px;margin-bottom:12px}.consent-dialog h3{margin:0 0 12px;font-size:18px;font-weight:700;color:#1a1a2e}.consent-dialog p{margin:0 0 12px;font-size:14px;color:#555;line-height:1.6}.consent-details{background:#f5f5f5;border-radius:8px;padding:10px 14px;font-size:12px;color:#777;margin-bottom:20px;line-height:1.5}.consent-buttons{display:flex;gap:12px;justify-content:center}.btn-consent-accept{padding:10px 28px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;background:#4f46e5;color:#fff;transition:background .2s}.btn-consent-accept:hover{background:#4338ca}.btn-consent-decline{padding:10px 28px;border:1px solid #ddd;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;background:0 0;color:#888;transition:.2s}.btn-consent-decline:hover{border-color:#bbb;color:#555}body.dark-mode .consent-dialog{background:#1e1e2e;box-shadow:0 20px 60px rgba(0,0,0,.6)}body.dark-mode .consent-dialog h3{color:#e0e0e0}body.dark-mode .consent-dialog p{color:#aaa}body.dark-mode .consent-details{background:#2a2a3e;color:#999}body.dark-mode .btn-consent-accept{background:#6366f1}body.dark-mode .btn-consent-accept:hover{background:#818cf8}body.dark-mode .btn-consent-decline{border-color:#444;color:#888}body.dark-mode .btn-consent-decline:hover{border-color:#666;color:#bbb}@media (max-width:480px){.consent-dialog{padding:24px 20px;max-width:95%}.consent-dialog-icon{font-size:36px}.consent-dialog h3{font-size:16px}.consent-buttons{flex-direction:column;gap:8px}.btn-consent-accept,.btn-consent-decline{width:100%}}.btn-ai{background:linear-gradient(135deg,#6366f1,#a78bfa)!important;color:#fff!important;border:none;position:relative}.btn-ai:hover{background:linear-gradient(135deg,#818cf8,#c4b5fd)!important;transform:translateY(-1px);box-shadow:0 4px 12px rgba(99,102,241,.4)}.ai-chat-panel{position:fixed;bottom:20px;right:20px;width:380px;max-height:520px;background:#fff;border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.2);display:flex;flex-direction:column;z-index:9000;overflow:hidden;transform:translateY(120%) scale(.9);opacity:0;transition:transform .3s,opacity .3s;pointer-events:none}.ai-chat-panel.show{transform:translateY(0) scale(1);opacity:1;pointer-events:auto}.ai-chat-header{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;padding:14px 16px;display:flex;align-items:center;justify-content:space-between}.ai-chat-title{font-weight:700;font-size:15px}.ai-chat-header-btns{display:flex;align-items:center;gap:8px}.ai-status{font-size:11px;background:rgba(255,255,255,.2);padding:2px 8px;border-radius:10px}.ai-chat-close{background:0 0;border:none;color:#fff;font-size:22px;cursor:pointer;padding:0 4px;line-height:1;opacity:.8}.ai-chat-close:hover{opacity:1}.ai-progress{padding:8px 16px;background:#f0f0ff}.ai-progress-bar-bg{height:6px;background:#e0e0e0;border-radius:3px;overflow:hidden}.ai-progress-bar{height:100%;width:0%;background:linear-gradient(90deg,#6366f1,#a78bfa);border-radius:3px;transition:width .3s}.ai-progress-text{font-size:11px;color:#888;display:block;text-align:right;margin-top:4px}.ai-chat-messages{flex:1;overflow-y:auto;padding:16px;min-height:200px;max-height:300px;display:flex;flex-direction:column;gap:10px}.ai-chat-msg{display:flex;gap:8px;align-items:flex-start;animation:.3s aiMsgFadeIn}@keyframes aiMsgFadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.ai-chat-avatar{font-size:20px;flex-shrink:0}.ai-chat-text{font-size:13px;line-height:1.5;color:#333;word-break:break-word}.ai-chat-msg-ai .ai-chat-text{background:#f5f5ff;padding:8px 12px;border-radius:12px 12px 12px 4px}.ai-chat-msg-user .ai-chat-text{background:#6366f1;color:#fff;padding:8px 12px;border-radius:12px 12px 4px;margin-left:auto}.ai-chat-msg-user{flex-direction:row-reverse}.ai-chat-input-area{display:flex;gap:8px;padding:12px 16px;border-top:1px solid #eee;background:#fafafa}.ai-chat-input{flex:1;border:1px solid #ddd;border-radius:8px;padding:8px 12px;font-size:13px;outline:0;transition:border-color .2s}.ai-chat-input:focus{border-color:#6366f1}.ai-chat-send{background:#6366f1;color:#fff;border:none;border-radius:8px;padding:8px 16px;font-size:13px;font-weight:600;cursor:pointer;transition:background .2s}.ai-chat-send:hover{background:#4f46e5}.ai-chat-footer{padding:8px 16px 12px;background:#fafafa;border-top:1px solid #eee;text-align:center}.ai-chat-load-btn{background:0 0;border:1px dashed #aaa;border-radius:6px;padding:6px 16px;font-size:12px;color:#888;cursor:pointer;transition:.2s}.ai-chat-load-btn:hover{border-color:#6366f1;color:#6366f1}body.dark-mode .ai-chat-panel{background:#1e1e2e;box-shadow:0 12px 40px rgba(0,0,0,.5)}body.dark-mode .ai-chat-messages{background:#1e1e2e}body.dark-mode .ai-chat-msg-ai .ai-chat-text{background:#2a2a3e;color:#ddd}body.dark-mode .ai-chat-text{color:#ddd}body.dark-mode .ai-chat-input-area{background:#15151f;border-top-color:#333}body.dark-mode .ai-chat-input{background:#2a2a3e;border-color:#444;color:#ddd}body.dark-mode .ai-chat-input:focus{border-color:#818cf8}body.dark-mode .ai-chat-footer{background:#15151f;border-top-color:#333}body.dark-mode .ai-chat-load-btn{border-color:#555;color:#888}body.dark-mode .ai-chat-load-btn:hover{border-color:#818cf8;color:#818cf8}body.dark-mode .ai-progress{background:#2a2a3e}body.dark-mode .ai-progress-bar-bg{background:#444}body.dark-mode .ai-progress-text{color:#888}@media (max-width:480px){.ai-chat-panel{bottom:0;right:0;width:100%;max-height:80vh;border-radius:16px 16px 0 0}}.agent-connection-panel{background:var(--gray-50);border:1px solid var(--gray-200);border-radius:8px;padding:10px;margin-bottom:8px;text-align:center}.connection-status{font-size:var(--text-md);font-weight:600}.connection-status.connected{color:var(--success-color)}.connection-status.disconnected{color:var(--esp32-color)}.popup-overlay{display:none;position:fixed;top:80px;right:20px;z-index:10000;animation:.4s ease-out slideInRight}.popup-overlay.active{display:block}.popup-overlay.minimized .popup-content,.popup-overlay.minimized .popup-footer{display:none}.popup-modal{background:#fff;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.12);width:420px;max-width:calc(100vw - 40px);max-height:calc(100vh - 120px);display:flex;flex-direction:column}.popup-header{background:var(--primary-color);color:#fff;padding:10px 16px;border-radius:8px 8px 0 0;font-size:var(--text-md);font-weight:600;display:flex;justify-content:space-between;align-items:center;cursor:move;user-select:none}.popup-header-title{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.popup-header-buttons{display:flex;gap:6px;margin-left:12px}.popup-header-btn{background:rgba(255,255,255,.15);border:none;color:#fff;width:24px;height:24px;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;transition:background .2s;flex-shrink:0}.popup-header-btn:hover{background:rgba(255,255,255,.3)}.popup-content{padding:16px;overflow-y:auto;flex:1;line-height:1.6;font-size:var(--text-md)}.popup-content p{margin:8px 0}.popup-content ul{margin:8px 0;padding-left:20px}.popup-content li{margin:4px 0}.popup-footer{padding:10px 16px;border-top:1px solid var(--gray-200);display:flex;justify-content:space-between;align-items:center;background:var(--gray-50);border-radius:0 0 8px 8px}.popup-checkbox{display:flex;align-items:center;gap:6px;font-size:var(--text-sm);color:#6c757d}.popup-checkbox input{cursor:pointer}.popup-button{background:var(--primary-color);color:#fff;border:none;padding:7px 18px;border-radius:6px;font-size:var(--text-base);font-weight:500;cursor:pointer;transition:opacity .2s}.popup-button:hover{opacity:.9}@keyframes slideInRight{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}@media (max-width:768px){.popup-overlay{top:10px;right:10px;left:10px}.popup-modal{width:100%}}